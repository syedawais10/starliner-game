<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Starliner: Trust No One</title>
  <style>
    body { margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; background: #0b0f1b; color: #e5e7eb; }
    .wrap { max-width: 960px; margin: 20px auto; padding: 16px; background: #121a2a; border: 1px solid rgba(255,255,255,.1); border-radius: 12px; }
    h1 { margin: 0 0 8px; display:flex; align-items:center; gap:8px; }
    input, button, select { font-size: 16px; }
    input[type="text"] { padding: 10px 12px; border-radius: 8px; border: 1px solid rgba(255,255,255,.15); background: #0f1424; color: #fff; }
    input[type="color"]{ width: 44px; height: 44px; padding: 0; border-radius: 8px; border: 1px solid rgba(255,255,255,.15); background: #0f1424; }
    select { padding: 10px 12px; border-radius: 8px; border: 1px solid rgba(255,255,255,.15); background: #0f1424; color: #fff; }
    button { padding: 10px 14px; border-radius: 8px; border: 1px solid rgba(255,255,255,.15); background: #1a1f3a; color: #fff; cursor: pointer; }
    button:disabled { opacity: .5; cursor: not-allowed; }
    .row { display: flex; gap: 8px; flex-wrap: wrap; align-items: center; margin: 8px 0; }
    .pill { padding: 6px 10px; background: #0f1424; border: 1px solid rgba(255,255,255,.1); border-radius: 999px; display: inline-block; }
    .muted { color: #9aa4b2; }
    .box { padding: 10px; background: #0e1423; border: 1px solid rgba(255,255,255,.1); border-radius: 8px; }

    #gameWrap { max-width: 960px; margin: 20px auto; padding: 10px; }
    #game { width: 100%; height: 540px; display: block; background: #0a0f1e; border: 1px solid rgba(255,255,255,.15); border-radius: 12px; }
    #hint { text-align: center; color: #9aa4b2; font-size: 14px; margin-top: 6px; }

    .overlay { position: fixed; inset: 0; display: none; place-items: center; background: radial-gradient(1200px 600px at 50% 30%, rgba(125,211,252,.08), rgba(0,0,0,.65)); padding: 16px; }
    .panel { width: min(800px, 100%); background: linear-gradient(180deg, rgba(26,31,58,.92), rgba(12,15,30,.92)); border: 1px solid rgba(255,255,255,.12); border-radius: 12px; padding: 14px; }
    #chat { height: 160px; overflow: auto; background: #0b1020; border: 1px solid rgba(255,255,255,.08); border-radius: 10px; padding: 8px; }
    #chat input { width: 100%; }
    .voice { display:flex; gap:8px; flex-wrap:wrap; }
    #voicePeers .pill { margin-top: 6px; }
    #hud { display:flex; justify-content:space-between; gap:10px; margin-top:6px; font-size:14px; color:#cbd5e1;}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>⭐ Starliner: Trust No One</h1>
    <p class="muted">Pick a color/hat/skin, create/join a room, and start. Voice only during meetings.</p>

    <div class="row">
      <label>Name</label>
      <input id="name" placeholder="Awais" maxlength="18" type="text" />
      <label>Room</label>
      <input id="room" placeholder="ABCDE" type="text" />
      <label>Color</label>
      <input id="color" type="color" value="#8b5cf6" title="Suit color" />
      <label>Hat</label>
      <select id="hat">
        <option value="none">None</option>
        <option value="cap">Cap</option>
        <option value="crown">Crown</option>
        <option value="flower">Flower</option>
        <option value="visor">Extra Visor</option>
      </select>
      <label>Skin</label>
      <select id="skin">
        <option value="none">None</option>
        <option value="stripe">Stripe</option>
        <option value="overalls">Overalls</option>
        <option value="suit">Suit</option>
      </select>
    </div>

    <div class="row">
      <button id="create">Create Room</button>
      <button id="join">Join Room</button>
      <button id="start" disabled>Start Game (Host)</button>
    </div>

    <div class="box">
      <div>Room ID: <b id="roomId">-</b></div>
      <div>Your ID: <span id="me" class="muted">-</span></div>
      <div>Host ID: <span id="host" class="muted">-</span></div>
      <div>Phase: <b id="phase">lobby</b></div>
      <div>Your Role: <b id="role">unknown</b></div>
      <div id="hud">
        <div>Tasks: <span id="tasksDone">0</span>/<span id="tasksTotal">0</span></div>
        <div id="taskHint" class="muted"></div>
      </div>
      <div style="margin-top:8px">Players: <span id="players" class="muted">none</span></div>
    </div>

    <div class="row">
      <button id="btnReport" disabled>Report</button>
      <button id="btnEmergency" disabled>Emergency</button>
      <button id="btnKill" disabled>Kill</button>
      <button id="btnSabotage" disabled>Sabotage</button>
      <button id="btnFix" disabled>Fix</button>
    </div>
  </div>

  <div id="gameWrap">
    <canvas id="game" width="960" height="540"></canvas>
    <div id="hint">Move with WASD. Press <b>E</b> to do tasks at yellow stations. Collision enabled.</div>
  </div>

  <!-- Meeting overlay -->
  <div class="overlay" id="meeting">
    <div class="panel">
      <h2>⏰ Emergency Meeting</h2>
      <div class="row" id="voteList"></div>
      <div class="row" style="margin-top:8px">
        <div style="flex:1 1 320px">
          <div id="chat"></div>
          <div class="row"><input id="chatInput" type="text" placeholder="Type to chat…" /></div>
        </div>
        <div style="flex:1 1 240px">
          <div class="voice">
            <button class="btn" id="vcJoin">Join Voice</button>
            <button class="btn" id="vcMute" disabled>Mute</button>
            <button class="btn" id="vcLeave" disabled>Leave</button>
          </div>
          <div id="voicePeers"></div>
        </div>
      </div>
      <div class="row" style="margin-top:8px">
        <button class="btn" id="voteSkip">Skip</button>
        <span class="muted">Meeting ends when everyone alive has voted.</span>
      </div>
    </div>
  </div>

  <script src="./client.js"></script>
</body>
</html>

<!-- Victory overlay -->
<div class="overlay" id="victory" style="display:none; pointer-events:auto; z-index:9999;">
  <div class="panel" style="text-align:center">
    <h2 id="victoryMsg">Game Over</h2>
    <p class="muted" id="victorySub">Thanks for playing!</p>
    <div class="row" style="justify-content:center;margin-top:10px">
      <button class="btn" id="btnPlayAgain">Return to Lobby</button>
    </div>
  </div>
</div>
